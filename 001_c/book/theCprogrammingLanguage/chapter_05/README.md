> **这是第五章的课后习题题目**

<br />

**01** 在上面的例子中，如果符号 + 或 - 的后面紧跟着的不是数字，getint 函数将把符号视为数字0的有效表达方式。修改该函数，将这种形式的 + 或 - 符号重新写回到输入流中。

**02** 模仿函数 getint 的实现方法，编写一个读取浮点数的函数 getfloat。getfloat 函数的返回值应该是什么类型？

**03** 用指针的方式实现第 2 章中的函数 strcat。函数 strcat(s, t) 将 t 指向的字符串复制到 s 指向的字符串的尾部。

**04** 编写函数 strend(s, t)。如果字符串 t 出现在字符串 s 的尾部，该函数返回 1；否则返回 0。

**05** 实现库函数 strncpy、strncat 和 strncmp, 它们最多对参数字符串中的前 n 个字符进行操作。例如，函数 strncpy(s, t, n) 将 t 中最多前 n 个字符复制到 s 中。更多的说明请参见附录 B。

**06** 采用指针而非数组索引的方式改写前面章节和联系中的某些程序，例如 getline（第1\、4章），atoi、itoa 以及它们的变形体（第2、 3、 4章），reverse（第3章），strindex，getop（第4章）。

**07** 重写函数 readlines，将输入的文本行存储到由 main 函数提供的一个数组中，而不是存储到调用的 alloc 分配的存储空间中。该函数的运行速度比改写前快多少？

**08** 函数 day\_of\_year 和 month\_day 中没有进行错误检查，请解决该问题。

**09** 用指针的方式代替数组下标方式改写函数 day\_of\_year 和 month\_day。

**10** 编写程序 expr，以计算从命令行输入的逆波兰表达式的值，其中每个运算符或操作数用一个单独的参数表示。例如，命令 <br />
　　expr 2 3 4 + * <br />
将计算表达式 2 × (3 + 4) 的值。

**11** 修改程序 entab 和 detab （第1章练习中编写的函数），使它们接受一组作为参数的制表符停止位。如果启动程序时不带参数，则使用默认的制表符停止位设置。

**12** 对程序 entab 和 detab 的功能做一些扩充，以接受下列缩写的命令。<br />
　　entab -m +n <br />
表示制表符从第 m 列开始，每隔 n 列停止。选择（对使用这而言）比较方便的默认行为。

**13** 编写程序 tail，将其输入中的最后 n 行打印出来。默认情况下，n 的值为 10，但可以通过一个可选的参数改变 n 的值，因此，命令 <br />
　　tail -n <br />
将打印其输入的最后 n 行。无论输入或 n 的值是否合理，该程序都应该能正常运行。编写的程序就要充分地利用存储空间；输入行的存储方式应该同 5.6 节中的排序程序的存储方式一样，而不是采用固定长度的二维数组。

**14** 修改排序程序，使它能处理 -r 标记。该标记表明，以逆序（递减）方式排序。要保证 -r 和 -n 能够组合在一起使用。

**15** 增加选项 -f，使得排序过程不考虑字母大小之间的区别。例如，比较 a 和 A 时认为它们相等。

**16** 增加选项 -d（代表目录顺序）。该选项表明，只对字母、数字和空格进行比较。要保证该选项可以和 -f 组合在一起使用。

**17** 增加字段处理功能，以使得排序程序可以根据行内的不同字段进行排序，没个字段按照一个单独的选项集合进行排序。（在对本书索引进行排序时，索引条目使用了 -df 选项，而对页码排序使用了 -n 选项。

**18** 修改 dcl 程序，使它能够处理输入中的错误。

**19** 修改 undcl 程序，使它在把文字描述转换为声明的过程中不会生成多余的圆括号。

**20** 扩展 dcl 程序的功能，使它能够处理包含其他成分的声明，例如带有函数参数类型的声明、带有类似于 const 限定符的声明等。

